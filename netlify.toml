# Netlify Configuration for Next.js 16
# Project is in devall-nextjs subfolder

[build]
  # Base directory where package.json is located
  base = "devall-nextjs"
  
  # Install command - explicitly install dependencies
  command = "npm ci && npm run build"
  
  # Publish directory - managed by Netlify Next.js plugin
  publish = ".next"

[build.environment]
  # Node version
  NODE_VERSION = "20.11.0"
  NPM_VERSION = "10.2.4"

# Next.js Runtime Plugin (Essential for Next.js on Netlify)
[[plugins]]
  package = "@netlify/plugin-nextjs"

# Redirects and Headers are handled by Next.js
# No need for manual _redirects file

# Environment variables (configure in Netlify dashboard)
# RESEND_API_KEY
# EMAIL_FROM
# EMAIL_TO
# NEXT_PUBLIC_SITE_URL

# Production context
[context.production]
  command = "npm run build"

# Deploy preview context
[context.deploy-preview]
  command = "npm run build"

# Branch deploy context
[context.branch-deploy]
  command = "npm run build"
